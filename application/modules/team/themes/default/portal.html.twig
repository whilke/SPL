{% extends _layout %}
{% block content %}
    <h2 style='text-align:center;'>{{team.name}} ( {{team.region}} )</h2><br/>
    <div class="col-md-12">        
        <div class="col-md-4">
            <div class="panel panel-info">
                <div class="panel-heading">
                    <h3 class="panel-title">Logo</h3>
                </div>
                {% if team.logo != ""%}
                    <div class="panel-body">
                        <img class="img-responsive center-block" style="margin-top:-10px;margin-bottom:-10px" src="{{team.logo}}"/>
                    </div>
                {% else %}
                    <div class="panel-body" style="height:220px;">
                    </div>
                {% endif %}
            </div> 
            <div class="panel panel-info">
                <div class="panel-heading">
                    <h3 class="panel-title">Strife Series Points</h3>
                </div>
                <div class="panel-body">
                    <div style="text-align:center;">{{season_points}}</div>
                </div>
            </div> 
        </div>
        <div class="col-md-4">
            <div class="panel panel-info">
                <div class="panel-heading">
                    <h3 class="panel-title">How to contact</h3>
                </div>
                <div class="panel-body">
                    {{team.contact}}
                </div>
            </div>
            <div class="panel panel-info">
                <div class="panel-heading">
                    <h3 class="panel-title">Record History</h3>
                </div>
                <div class="panel-body">
                    <table align='center'>
                        <thead>
                            <tr>
                                <th width='150px'>Series</th>
                                <th width='50px'>W - L</th>
                                <th width='50px'>Win %</th>
                                <th width='50px'>Points</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for stat in season_stats %}
                            <tr>
                                <td>{{stat.name}}</td>
                                <td>{{stat.wins}} - {{stat.loss}}</td>
                                <td>{{stat.perc}}%</td>
                                <td>{{stat.points}}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
            <div class="col-md-4">
             <div class="panel panel-info">
                <div class="panel-heading">
                    <h3 class="panel-title">Captain</h3>
                </div>
                <div class="panel-body">
                    {{team.captain}}
                </div>
            </div>
           <div class="panel panel-info">
                <div class="panel-heading">
                    <h3 class="panel-title">Active Roster</h3>
                </div>
                <div class="panel-body">
                    {{team.slot1}}<br/>
                    {{team.slot2}}<br/>
                    {{team.slot3}}<br/>
                    {{team.slot4}}<br/>
                </div>
                <div class="panel-heading">
                    <h3 class="panel-title">Active Subs</h3>
                </div>
                <div class="panel-body">
                    {{team.slot5}}<br/>
                    {{team.slot6}}<br/>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-10 col-md-offset-1">   
        <table id="matches" class="table table-bordered table-hover" style="border: 0px;">
            <thead>
                <tr>
                    <th class="text-center" style='width:800px;'>( Home vs Away )</th>
                    <th class="text-center"  style='width:320px'>Date</th>
                    <th class="text-center"  style='width:100px'>Result</th>
                    <th class="text-center"  style='width:100px'>Points</th>
                    <th class="text-center"  style='width:200px'>Match ID</th>
                </tr>
            </thead>
            <tbody>
                {% for match in matches %}
                    <tr>
                        {% set s = 'team/portal/' ~ match.home_team_id    %}
                        {% set s2 = 'team/portal/' ~ match.away_team_id    %}
                    <td><a style="color:red;" href="{{s|site_url}}">{{match.homeTeam}}</a> vs 
                        <a style="color:green;" href="{{s2|site_url}}">{{match.awayTeam}}</a</td>
                        <td class="text-center">{{match.gamedate}}</td>
                        
                        {% if match.home_team_id == team.id %}
                        <td class="text-center">{{match.hscode}}</td>
                        {% else %}
                        <td class="text-center">{{match.awcode}}</td>
                        {% endif %}
                        
                        {% if match.active == true %}
                            <td></td>
                        {% else %}
                        {% if match.home_team_id == team.id %}
                        <td class="text-center">{{match.home_team_points}}</td>
                        {% else %}
                        <td class="text-center">{{match.away_team_points}}</td>
                        {% endif %}
                        {% endif %}
                        
                        {% set l = 'standings/match/' ~ match.id %}                        
                        <td class="text-center"><a href="{{l|site_url}}">{{match.seasontag}}:{{match.weektag}}:{{match.name}}</a></td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        <div style="font-size:10px;color:grey;" class="text-right">(*stats are delayed by one week)</div>
    </div>
{% endblock %}

{% block js %}
<script src="{{'js/moment.min.js'|assets_url()}}"></script>
<script type="text/javascript">
    function getTimezone()
    {
        var now = new Date().toString();
        var TZ = now.indexOf('(') > -1 ?
        now.match(/\([^\)]+\)/)[0].match(/[A-Z]/g).join('') :
        now.match(/[A-Z]{3,4}/)[0];
        if (TZ == "GMT" && /(GMT\W*\d{4})/.test(now)) TZ = RegExp.$1;
        return TZ;
    }
    
    $( document ).ready(function() {
        $("#matches").find("td:nth-child(2)").each(function () {
            var $this = $(this);
            $schDate = $this.html();
            if ($schDate != 0)
            {
                var strDateTime = $schDate;
                var myDate = moment(strDateTime);
                $this.html( myDate.format("MM/DD/YYYY hh:mm A ") + getTimezone() );
            }
            
        });
    }); 
</script>
{% endblock %}